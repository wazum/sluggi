{"version":3,"file":"redirect-notification-handler.js","sources":["../../../src/redirect-notification-handler.ts"],"sourcesContent":["const STORAGE_KEY = 'sluggi-redirect-choice';\n\ninterface RedirectChoice {\n    pageId: string;\n    createRedirects: boolean;\n    timestamp: number;\n}\n\ninterface SlugChangedEventDetail {\n    autoCreateRedirects?: boolean;\n}\n\nclass RedirectNotificationHandler {\n    constructor() {\n        document.addEventListener('typo3:redirects:slugChanged', (event) => this.onSlugChanged(event as CustomEvent<SlugChangedEventDetail>), true);\n    }\n\n    static storeChoice(pageId: string, createRedirects: boolean): void {\n        localStorage.setItem(STORAGE_KEY, JSON.stringify({ pageId, createRedirects, timestamp: Date.now() }));\n    }\n\n    static getAndClearChoice(): RedirectChoice | null {\n        const stored = localStorage.getItem(STORAGE_KEY);\n        if (!stored) return null;\n\n        localStorage.removeItem(STORAGE_KEY);\n\n        try {\n            const data = JSON.parse(stored) as RedirectChoice;\n            if (Date.now() - data.timestamp > 30000) return null;\n            return data;\n        } catch {\n            return null;\n        }\n    }\n\n    onSlugChanged(event: CustomEvent<SlugChangedEventDetail>): void {\n        const choice = RedirectNotificationHandler.getAndClearChoice();\n        if (choice && !choice.createRedirects && event.detail?.autoCreateRedirects) {\n            event.detail.autoCreateRedirects = false;\n        }\n    }\n}\n\nexport { RedirectNotificationHandler };\nexport default new RedirectNotificationHandler();\n"],"names":["STORAGE_KEY","RedirectNotificationHandler","event","pageId","createRedirects","stored","data","_a","choice"],"mappings":"AAAA,MAAMA,EAAc,yBAYpB,MAAMC,CAA4B,CAC9B,aAAc,CACV,SAAS,iBAAiB,8BAAgCC,GAAU,KAAK,cAAcA,CAA4C,EAAG,EAAI,CAC9I,CAEA,OAAO,YAAYC,EAAgBC,EAAgC,CAC/D,aAAa,QAAQJ,EAAa,KAAK,UAAU,CAAE,OAAAG,EAAQ,gBAAAC,EAAiB,UAAW,KAAK,IAAA,CAAI,CAAG,CAAC,CACxG,CAEA,OAAO,mBAA2C,CAC9C,MAAMC,EAAS,aAAa,QAAQL,CAAW,EAC/C,GAAI,CAACK,EAAQ,OAAO,KAEpB,aAAa,WAAWL,CAAW,EAEnC,GAAI,CACA,MAAMM,EAAO,KAAK,MAAMD,CAAM,EAC9B,OAAI,KAAK,IAAA,EAAQC,EAAK,UAAY,IAAc,KACzCA,CACX,MAAQ,CACJ,OAAO,IACX,CACJ,CAEA,cAAcJ,EAAkD,CApCpE,IAAAK,EAqCQ,MAAMC,EAASP,EAA4B,kBAAA,EACvCO,GAAU,CAACA,EAAO,mBAAmBD,EAAAL,EAAM,SAAN,MAAAK,EAAc,uBACnDL,EAAM,OAAO,oBAAsB,GAE3C,CACJ,CAGe,IAAID"}