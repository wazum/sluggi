name: Backport

on:
  pull_request_target:
    types: [closed, labeled]

jobs:
  backport:
    if: github.event.pull_request.merged == true && contains(toJSON(github.event.pull_request.labels.*.name), 'backport:')
    runs-on: ubuntu-latest
    steps:
      - name: Backport merged pull request
        uses: korthout/backport-action@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          # Label format: "backport:demo-13.x" → creates PR to demo-13.x branch
          # Label format: "backport:demo-12.x" → creates PR to demo-12.x branch
